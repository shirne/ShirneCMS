function del(t,e){return dialog.confirm(e,function(){location.href=$(t).attr("href")}),!1}function lang(t){return window.language&&window.language[t]?window.language[t]:t}function randomString(t,e){for(var n="",i=(e=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,o=0;o<t;o++){var a=Math.floor(Math.random()*i);n+=e.substring(a,a+1)}return n}function parseObject(t){try{var e=JSON.parse(t);if(e)return e}catch(t){console.error(t)}return{}}function parseArray(t){try{var e=JSON.parse(t);if(e instanceof Array)return e}catch(t){console.error(t)}return[]}function strPad(t,e,n){return(t=t.toString()).length>=e?t:strPad(n+t,e,n)}function copy_obj(t){return JSON.parse(JSON.stringify(t))}function isObjectValueEqual(t,e){if(t||e){if(!t||!e)return!1;var n=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(e);if(n.length!=i.length)return!1;for(var o=0;o<n.length;o++){var a=n[o];if(t[a]!==e[a])return!1}}return!0}function array_combine(t,e){for(var n={},i=0;i<t.length&&!(e.length<i+1);i++)n[t[i]]=e[i];return n}function tostring(t){return t&&t.toString?t.toString():""}function callfunc(t,e,n,i){var o;return n?0<=(o=(n="string"==typeof n?n.split(","):n).indexOf("###"))?n[o]=t:n=[t].concat(n):n=[t],window[e]?window[e].apply(i,n):null==t?"":t}function html_encode(t){var e,n;return t&&(null!=(n=document.createElement("div")).textContent?n.textContent=t:n.innerText=t,e=n.innerHTML,n=null,e)}function html_decode(t){var e,n;return t&&((n=document.createElement("div")).innerHTML=t,e=n.innerText||n.textContent,n=null,e)}function pad_zero(t,e){return(t+="").length<e?new Array(++e-t.length).join("0")+t:t}function timestamp_date(t,e){var i,n,o,a,s;return t?(i=new Date(1e3*t),n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={1:"st",2:"nd",3:"rd",21:"st",22:"nd",23:"rd",31:"st"},a=["","January","February","March","April","May","June","July","August","September","October","November","December"],s={d:function(){return pad_zero(s.j(),2)},D:function(){return s.l().substr(0,3)},j:function(){return i.getDate()},l:function(){return n[s.w()]},N:function(){return s.w()+1},S:function(){return o[s.j()]?o[s.j()]:"th"},w:function(){return i.getDay()},z:function(){return(i-new Date(i.getFullYear()+"/1/1"))/864e5>>0},W:function(){var t=s.z(),e=364+s.L()-t,n=(new Date(i.getFullYear()+"/1/1").getDay()||7)-1;return e<=2&&(i.getDay()||7)-1<=2-e?1:t<=2&&4<=n&&6-n<=t?(e=new Date(i.getFullYear()-1+"/12/31"),timestamp_date(Math.round(e.getTime()/1e3),"W")):1+(n<=3?(t+n)/7:(t-(7-n))/7)>>0},F:function(){return a[s.n()]},m:function(){return pad_zero(s.n(),2)},M:function(){return s.F().substr(0,3)},n:function(){return i.getMonth()+1},t:function(){var t;return 2==(t=i.getMonth()+1)?28+s.L():1&t&&t<8||!(1&t)&&7<t?31:30},L:function(){var t=s.Y();return 3&t||!(t%100)&&t%400?0:1},Y:function(){return i.getFullYear()},y:function(){return(i.getFullYear()+"").slice(2)},a:function(){return 11<i.getHours()?"pm":"am"},A:function(){return s.a().toUpperCase()},B:function(){var t=60*(i.getTimezoneOffset()+60),t=3600*i.getHours()+60*i.getMinutes()+i.getSeconds()+t,t=Math.floor(t/86.4);return 1e3<t&&(t-=1e3),t<0&&(t+=1e3),1==String(t).length&&(t="00"+t),t=2==String(t).length?"0"+t:t},g:function(){return i.getHours()%12||12},G:function(){return i.getHours()},h:function(){return pad_zero(s.g(),2)},H:function(){return pad_zero(i.getHours(),2)},i:function(){return pad_zero(i.getMinutes(),2)},s:function(){return pad_zero(i.getSeconds(),2)},O:function(){var t=pad_zero(Math.abs(i.getTimezoneOffset()/60*100),4);return t=0<i.getTimezoneOffset()?"-"+t:"+"+t},P:function(){var t=s.O();return t.substr(0,3)+":"+t.substr(3,2)},c:function(){return s.Y()+"-"+s.m()+"-"+s.d()+"T"+s.h()+":"+s.i()+":"+s.s()+s.P()},U:function(){return Math.round(i.getTime()/1e3)}},(e=e||"Y-m-d H:i:s").replace(/[\\]?([a-zA-Z])/g,function(t,e){return t==e&&s[e]?s[e]():e})):""}function iif(t,e,n){return(t="0"===t?0:t)?e:n}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function transOption(t){if(!t)return{};var e,n={};for(e in t)n[e.replace(/(_|-)[a-z]/g,function(t){return t.substring(1).toUpperCase()})]=t[e];return n}Number.prototype.format=function(t){for(var t=this.toFixed(t=void 0===t?2:t).split("."),e=[],n=t[0].split(""),i=n.length,o=0;o<i;o++)0<o&&o%3==0&&e.unshift(","),e.unshift(n[i-o-1]);return e.join("")+(2==t.length?"."+t[1]:"")},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s+|\s+$)/g,"")}),String.prototype.compile=function(r,t){if(t){var e,n=[];for(e in r)n.push(this.compile(r[e]));return n.join("\n")}return this.replace(/\{if\s+([^\}]+)\}([\W\w]*?){\/if}/g,function(t,e,n){var i=n.split("{else}");if(o=e.match(/\s+(=+|<|>)\s+/)){var o=o[0],a=e.split(o),s=(0===a[0].indexOf("@")&&(a[0]=r[a[0].replace("@","")]),0===a[1].indexOf("@")&&(a[1]=r[a[1].replace("@","")]),!1);switch(o=o.trim()){case"==":s=a[0]==a[1];break;case"===":s=a[0]===a[1];break;case">":s=a[0]>a[1];break;case"<":s=a[0]<a[1]}if(s)return n}else if(r[e.replace("@","")])return i[0];return i[1]||""}).replace(/\{@([\w\d\.]+)(?:\|([\w\d]+)(?:\s*=\s*([^\}]+))?)?\}/g,function(t,e,n,i){if(0<e.indexOf(".")){for(var o=e.split("."),a=r,s=0;s<o.length;s++){if(null==a[o[s]]){a="";break}a=a[o[s]]}return callfunc(a,n,i)}return callfunc(r[e],n,i,r)})},window.default=function(t,e){return t||e},((o,y)=>{var a=0;function s(t,e){return(t=_typeof(t)===_typeof("a")?{text:t,isdefault:!!e}:t).isdefault&&!t.type&&(t.type="primary"),t}function w(t){if((t=t||{}).btns)if("string"==typeof t.btns)t.btns=[s(t.btns,!0)];else if(t.btns instanceof Array)for(var e=0;e<t.btns.length;e++)t.btns[e]=s(t.btns[e]);else console.error("Dialog::construct argument btns error."),t.btns=[];this.options=y.extend({id:"modal_dialog_"+a++,header:!0,footer:!0,backdrop:!0,tabindex:-1,size:"",btns:[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}],contentClass:"",onsure:null,onshow:null,onshown:null,onhide:null,onhidden:null},t),this.options.btns||(this.options.btns=[]);var n=this.options.btns.length;if(t.addbtn&&(this.options.btns||(this.options.btns=[]),t.addbtn=s(t.addbtn),n<1?this.options.btns.unshift(t.addbtn):this.options.btns.splice(n-1,0,t.addbtn),n=1),t.addbtns){if(this.options.btns||(this.options.btns=[]),n<1)this.options.btns=t.addbtns;else{for(var i=[n-1,0],e=0;e<t.addbtns.length;e++)i.push(s(t.addbtns[e]));this.options.btns.splice.apply(this.options.btns,i)}n=1}n<1&&(this.options.footer=!1),this.closed=!0,this.box=y(this.options.id)}w.prototype.generBtn=function(t,e){return t.type&&(t.class="btn-outline-"+t.type),'<a href="javascript:" class="nav-item btn '+(t.class||"btn-outline-secondary")+'" '+(t.isdefault?"default":"")+' data-index="'+e+'">'+t.text+"</a>"},w.prototype.getDefaultBtn=function(){for(var t=null,e=0;e<this.options.btns.length&&!(t=this.options.btns[e]).isdefault;e++);return t},w.prototype.show=function(t,e){this.box=y("#"+this.options.id),e=e||"系统提示",this.box.length<1?(y(document.body).append('<div class="modal shirne-modal fade" id="{@id}" {if tabindex}tabindex="{@tabindex}"{/if} role="dialog" aria-labelledby="{@id}Label" >\n    <div class="modal-dialog {@size}">\n        <div class="modal-content {@contentClass}">\n            <div class="modal-header">\n                <h4 class="modal-title" id="{@id}Label">{@title}</h4>\n                <button type="button" class="close" data-dismiss="modal">\n                    <span>&times;</span>\n                    <span class="sr-only">Close</span>\n                </button>\n            </div>\n            <div class="modal-body {@bodyClass}">\n            </div>\n            <div class="modal-footer">\n                <nav class="nav nav-fill"></nav>\n            </div>\n        </div>\n    </div>\n</div>'.compile({id:this.options.id,bodyClass:this.options.bodyClass,contentClass:this.options.contentClass,tabindex:this.options.tabindex,size:this.options.size?"modal-"+this.options.size:"",title:e})),this.box=y("#"+this.options.id)):(this.box.unbind(),this.box.find(".modal-title").text(e)),this.options.header||this.box.find(".modal-header").remove(),this.options.footer||this.box.find(".modal-footer").remove(),!0!==this.options.backdrop&&(this.box.data("backdrop",this.options.backdrop),!1===this.options.backdrop)&&this.box.css({height:0,overflow:"visible"}),this.options.keyboard||this.box.data("keyboard",!1);for(var n=this,i=(w.instance=n,[]),o=0;o<this.options.btns.length;o++)i.push(this.generBtn(this.options.btns[o],o));this.box.find(".modal-footer .nav").html(i.join("\n"));var a=this.box.find(".modal-body");return a.html(t),this.box.on("hide.bs.modal",function(){n.options.onhide&&n.options.onhide(a,n.box),w.instance=null}),this.box.on("hidden.bs.modal",function(){n.options.onhidden&&n.options.onhidden(a,n.box),n.closed=!0,n.box.remove(),n.box=null}),this.box.on("show.bs.modal",function(){n.options.onshow&&n.options.onshow(a,n.box)}),this.box.on("shown.bs.modal",function(){if(n.box&&n.closed)return n.box.modal("hide");n.options.onshown&&n.options.onshown(a,n.box)}),this.options.footer&&this.box.find(".modal-footer .btn").click(function(){var t=!0,e=y(this).data("index");n.options.btns[e].click?t=n.options.btns[e].click.apply(this,[a,n.box]):n.options.btns[e].isdefault&&n.options.onsure&&(t=n.options.onsure.apply(this,[a,n.box])),!1!==t&&n.box.modal("hide")}),this.closed=!1,this.box.modal("show"),this},w.prototype.hide=w.prototype.close=function(){return this.box&&!this.closed&&(this.closed=!0,this.box.modal("hide")),this};var g={error:function(t,e){return this.message(t,"error",e)},success:function(t,e){return this.message(t,"success",e)},warning:function(t,e){return this.message(t,"warning",e)},info:function(t,e){return this.message(t,"info",e)},loading:function(t,e){return this.message(t||"加载中...","loading",e)},message:function(t,e,n){var i="bg-info text-white",o="information-circle";if(e)switch(e){case"danger":case"error":o="close-circle",i="bg-danger text-white";break;case"warning":o="warning",i="bg-warning text-white";break;case"loading":o='<div class="spinner-border text-light" role="status">\n  <span class="sr-only">Loading...</span>\n</div>',i="bg-info text-white",n=n||10;break;case"success":o="checkmark-circle",i="bg-success text-white"}var t='<div class="dialog-message" >'+(o="loading"!=e?'<i class="ion-md-'+o+'"></i>':o)+'&nbsp;&nbsp;<span class="message-text">'+t+"</span>"+("loading"==e?"":'<a href="javascript:" class="ion-md-close closebtn"></a>')+"</div>",a=new w({footer:!1,header:!1,backdrop:!1,tabindex:"",size:"sm",contentClass:i,onshow:function(t){t.find(".closebtn").click(function(){a.close()})}}).show(t,"");return 0<(n=n||2)&&setTimeout(function(){a.close()},1e3*n),a},alert:function(t,e,n){var i=!1,o="function"==typeof e,a="",s="sm",r="",c="确定";if(void 0===e||o||(n=e),y.isPlainObject(t)){if(t.title&&(a=t.title),void 0!==t.size&&(s=t.size),void 0!==t.buttonText&&(c=t.buttonText),void 0===t.content)throw"message.content can not be empty.";t=t.content}var l={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},d="primary";return void 0===n?n="information-circle":l[n]&&(d="error"==n?"danger":n,n=l[n]),r=n?"none"==n?'<div class="container-fluid">{@message}</div>'.compile({message:t}):'<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:n,color:d}):t,new w({btns:c,size:s,header:!!a,onsure:function(){if(o)return e(i=!0)},onhide:function(){!i&&o&&e(!1)}}).show(r,a)},confirm:function(t,e,n,i,o){var a=!1,s=("function"!=typeof e?(i=e,"function"==typeof n?(e=n,n=null):o=n):"function"!=typeof n&&(o=i,i=n),"number"==typeof i&&(o=i,i=void 0),null),r="",c="sm",l=[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}];if(y.isPlainObject(t)){if(t.title&&(r=t.title),void 0!==t.size&&(c=t.size),void 0!==t.btns&&(l=t.btns),void 0===t.content)throw"message.content can not be empty.";void 0!==t.onshown&&(s=t.onshown),t.cancel_text&&(l[0].text=t.cancel_text),t.confirm_text&&(l[1].text=t.confirm_text),t=t.content}var d,p,u={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},h="primary",u=(void 0===i?i="information-circle":u[i]&&(h="error"===i?"danger":i,i=u[i]),"none"==i?'<div class="container-fluid">{@message}</div>'.compile({message:t}):'<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:i,color:h})),f=0,t=new w({header:!!r,size:c,backdrop:"static",onshown:s,btns:l,onsure:function(){if(e&&"function"==typeof e)return a=!0,e()},onhide:function(){if(clearInterval(f),!1===a&&"function"==typeof n)return n()}}).show(u,r);return o&&"number"==typeof o&&(d=t.box.find(".modal-footer .btn-outline-primary"),p=t.getDefaultBtn().text,d.addClass("disabled").text(p+"("+o+")"),f=setInterval(function(){0<--o?d.text(p+"("+o+")"):(d.text(p),d.removeClass("disabled"),clearInterval(f))},1e3)),t},prompt:function(o,i,t){var a=!1,e='<div class="form-group">{@input}</div>',n="请输入信息",s=!1,r=!1,c={},l=!0,d="",p=("string"==typeof o?n=o:(n=o.title,o.content&&(e=-1<o.content.indexOf("{@input}")?o.content:o.content+e),o.multi&&(s=!0,c=o.multi),o.is_textarea&&(r=!0),void 0!==o.keyboard?l=o.keyboard:r&&(l=!1),o.default&&(d=s?o.default:o.default.toString())),'<input type="text" name="confirm_input" class="form-control prompt-control" />');if(r&&(p='<textarea name="confirm_input" class="form-control prompt-control" ></textarea>'),s)for(var u in p="",c){var h=c[u],f="",m=!1,g="",b=[];if("object"===_typeof(h)){if(f=h.value||"",m=h.is_textarea||r,g=h.type,h.values)for(var v in h.values)b.push({value:v,label:h.values[v]});h=h.label||h.title||u}p+=m?'<div class="input-group mt-2"><div class="input-group-prepend"><span class="input-group-text">'+h+'</span></div><textarea name="'+u+'" class="form-control prompt-control" >'+f+"</textarea></div>":"radio"==g?'<div class="form-group mt-2"><label class="form-label mr-3">'+h+"</label>"+b.map(function(t){return'<div class="form-check form-check-inline">  <input class="form-check-input prompt-control" type="radio" name="'+u+'" id="prompt-radio-'+u+"-"+t.value+'" value="'+t.value+'">  <label class="form-check-label" for="prompt-radio-'+u+"-"+t.value+'">'+t.label+"</label></div>"}).join("")+"</div>":"checkbox"==g?'<div class="form-group mt-2"><label class="form-label">'+h+"</label>"+b.map(function(t){return'<div class="form-check form-check-inline">  <input class="form-check-input prompt-control" type="checkbox" name="'+u+'" id="prompt-checkbox-'+u+"-"+t.value+'" value="'+t.value+'">  <label class="form-check-label" for="prompt-checkbox-'+u+"-"+t.value+'">'+t.label+"</label></div>"}).join("")+"</div>":"select"==g?'<div class="input-group mt-2"><div class="input-group-prepend"><span class="input-group-text">'+h+'</span></div><select class="form-control prompt-control" name="'+u+'">'+b.map(function(t){return'<option value="'+t.value+'">'+t.label+"</option>"}).join("")+"</select></div>":'<div class="input-group mt-2"><div class="input-group-prepend"><span class="input-group-text">'+h+'</span></div><input type="text"  name="'+u+'" value="'+f+'" class="form-control prompt-control" /></div>'}return new w({backdrop:"static",keyboard:l,onshow:function(t){o&&o.onshow&&o.onshow(t)},onshown:function(t){var e=t.find(".prompt-control").eq(0);if(d)if("object"===_typeof(d))for(var n in d){var i=t.find("[name="+n+"]");"radio"==i.attr("type")?i.each(function(){y(this).val()==d[n]&&y(this).prop("checked",!0)}):i.val(d[n])}else e.val(d);e.select(),o&&o.onshown&&o.onshown(t)},onsure:function(t){var e=t.find(".prompt-control"),n=e.val();if(s&&(n={},e.each(function(){var t=y(this).attr("name");"radio"==y(this).attr("type")?y(this).prop("checked")&&(n[t]=y(this).val()):"checkbox"==y(this).attr("type")?(n[t]||(n[t]=[]),y(this).prop("checked")&&n[t].push(y(this).val())):n[t]=y(this).val()})),"function"==typeof i)return!0===(e=i(n,t))&&(a=!0),e},onhide:function(){if(0==a&&"function"==typeof t)return t()}}).show(e.compile({input:p}),n)},action:function(t,n,e){var t='<div class="list-group"  style="max-height: 70vh;overflow: auto;"><a href="javascript:" class="list-group-item list-group-item-action">'+t.join('</a><a href="javascript:" class="list-group-item list-group-item-action">')+"</a></div>",i=null,o=new w({bodyClass:"modal-action",backdrop:"static",size:"sm",btns:[{text:"取消",type:"secondary"}],onshow:function(t){(i=t.find(".list-group-item-action")).click(function(t){i.removeClass("active"),y(this).addClass("active");var e=i.index(this);"function"==typeof n&&!1===n(e)||o.close()})},onsure:function(t){return!0},onhide:function(){return!0}}).show(t,e||"请选择")},pickTree:function(l,n,d){"string"==typeof l&&(l={url:l});var t=(l="[object Array]"==Object.prototype.toString.call(l)?{isajax:!1,list:l}:l).icon?'<i class="ion-md-checkmark"></i> ':"",i=l&&l.idkey?l.idkey:"id",o=l&&l.titlekey?l.titlekey:"title",p=l&&l.isMulti,u={id:0,pid:-1,title:(l=y.extend({url:"",title:"",isajax:!0,initTree:"",isMulti:!1,globalSearch:!1,list:[],name:"项目",idkey:i,pidkey:"pid",titlekey:o,level:3,onRow:null,toList:function(t){return t.data},breadTemplate:'<li class="breadcrumb-item" aria-current="page"><a href="javascript:" data-id="{@'+i+'}">{@'+o+"}</a></li>",rowTemplate:'<a href="javascript:" data-id="{@'+i+'}" class="list-group-item list-group-item-action" style="line-height:30px;"><span class="item-name">'+t+"[{@"+i+"}]&nbsp;{if @tree_names}{@tree_names}{else}{@"+o+"}{/if}</span>"+(p?'<i class="ion-md-add add"></i>':"")+"</a>"},l||{})).name},h=[u],f=l.selected||[],t=(d=d||{},"请选择"+l.name),i='<div class="list-group list-group-picker mt-2" style="max-height:500px;overflow: auto;"></div>',m=(l.isajax&&(i='<nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item active" aria-current="page"><a href="javascript:" data-id="0">'+l.name+"</a></li></ol></nav>"+i),p&&(i='<div class="multi-box"></div>'+i),l.globalSearch&&(i='<div class="input-group search-box mb-2"><input type="text" class="form-control" /><div class="input-group-append"><button class="btn btn-outline-secondary search-btn" type="button" ><i class="ion-md-search"></i></button></div></div>'+i),l.title||(l.title=t),new w({backdrop:"static",onshown:function(n){var i=n.find(".breadcrumb"),t=n.find(".multi-box"),o=n.find(".list-group"),a=0;function s(){p&&t.html(f.map(function(t,e){return'<span class="badge badge-secondary" data-idx="'+e+'">'+t[l.titlekey]+'<a href="javascript:" class="close" aria-label="移除">&times;</a></span>'}).join(""))}function r(t){for(var e=0;e<l.list.length;e++)if(l.list[e][l.idkey]==t)return l.list[e];return null}function c(t){var e=(new Date).getTime();a=e,!1!==t&&(d.pid=h[h.length-1][l.idkey]),y.ajax({url:l.url,type:"GET",dataType:"JSON",data:d,success:function(t){e==a&&(1===t.code?(t=l.toList(t))&&t.length&&(l.list=t,o.html(l.rowTemplate.compile(t,!0))):o.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>'))}})}n.find(".search-btn").click(function(){var t=n.find(".search-box input[type=text]").val();t?c(!(d={key:t,pid:-1})):(d={},c())}),p&&(t.on("click",".badge .close",function(){var t=y(this).parents(".badge").data("idx");f.splice(t,1),s()}),o.on("click",".list-group-item .add",function(t){var e=r(y(this).parents(".list-group-item").eq(0).data("id"));e&&(f.push(e),s())})),o.on("click",".list-group-item",function(){var t;y(e.target).is(".add")||(t=r(y(this).data("id")))&&(o.find("a.list-group-item").removeClass("active"),y(this).addClass("active"),t.tree?(h=t.tree).unshift(u):(t.pid==h[h.length-1].pid&&h.pop(),h.push(t)),h.length<=l.level?m.box.find(".modal-footer .btn-outline-primary").prop("disabled",!0):m.box.find(".modal-footer .btn-outline-primary").prop("disabled",!1),i.html(l.breadTemplate.compile(h,!0)),c())}),i.on("click",".breadcrumb-item a",function(){var e=y(this).data("id"),t=h.findIndex(function(t){return t.id==e});-1<t&&(h=h.slice(0,t+1),i.html(l.breadTemplate.compile(h,!0)),c())}),l.isajax?l.initTree?y.ajax({url:l.url,type:"GET",dataType:"JSON",data:{tree:l.initTree},success:function(t){1===t.code&&t.data&&t.data.length?((h=t.data).unshift(u),i.html(l.breadTemplate.compile(h,!0))):o.html('<span class="text-danger"><i class="ion-md-warning"></i> 初始化失败</span>'),c()}}):c():o.html(l.rowTemplate.compile(l.list,!0))},onsure:function(t){return l.isMulti?f.length<1?(g.warning("没有选择"+l.name+"!"),!1):"function"==typeof n?n(f):void 0:h.length<l.level?(g.warning("没有选择"+l.name+"!"),!1):"function"==typeof n?n(h.slice(1)):void 0}}).show(i,l.title));return m},pickList:function(l,e,d){"string"==typeof l&&(l={url:l});var t=(l="[object Array]"==Object.prototype.toString.call(l)?{isajax:!1,list:l}:l).icon?'<i class="ion-md-checkmark"></i> ':"",p=(l=y.extend({url:"",title:"",isajax:!0,autoSearch:!0,list:[],name:"项目",searchHolder:"根据名称搜索",idkey:"id",titlekey:"title",searchkey:"key",onRow:null,extend:null,toList:function(t){return t.data instanceof Array?t.data:t.data.lists||[]},rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action" style="line-height:30px;">'+t+"[{@id}]&nbsp;{@title}</a>"},l||{}),null),t="",n=(l.extend&&(t='<select name="'+l.extend.name+'" class="form-control"><option value="">'+l.extend.title+"</option></select>"),d=d||{},"请选择"+l.name),i='<div class="list-group list-group-picker mt-2" style="max-height:500px;overflow: auto;"></div>';return l.isajax&&(n="请搜索并选择"+l.name,i='<div class="input-group">'+t+'<input type="text" class="form-control searchtext" name="keyword" placeholder="'+l.searchHolder+'"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div>'+i),l.title||(l.title=n),new w({backdrop:"static",onshown:function(t){var n,i,e,o=t.find(".searchbtn"),a=t.find(".searchtext"),s=t.find(".list-group"),r=!1;function c(){var e=(new Date).getTime();i=e,d[l.searchkey]=a.val(),l.extend&&(d[l.extend.name]=n.val()),y.ajax({url:l.url,type:"GET",dataType:"JSON",data:d,success:function(t){e==i&&(r=!1,1===t.code?(l.list=l.toList(t),l.list&&l.list.length?s.html(l.rowTemplate.compile(l.list,!0)):s.html('<span class="list-loading"><i class="ion-md-warning"></i> 没有检索到'+l.name+"</span>")):s.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>'))}})}s.on("click","a.list-group-item",function(){for(var t=y(this).data("id"),e=0;e<l.list.length;e++)if(l.list[e][l.idkey]==t){p=l.list[e],s.find("a.list-group-item").removeClass("active"),y(this).addClass("active");break}}),l.isajax?(n=null,l.extend&&(n=t.find("[name="+l.extend.name+"]"),l.extend.list?n.append(l.extend.htmlRow.compile(l.extend.list,!0)):y.ajax({url:l.extend.url,type:"GET",dataType:"JSON",success:function(t){t.data instanceof Array?n.append(l.extend.htmlRow.compile(t.data,!0)):t.data.lists&&n.append(l.extend.htmlRow.compile(t.data.lists,!0))}})),i=0,o.click(function(){r||(r=!0,s.html('<span class="list-loading">加载中...</span>'),c())}).trigger("click"),l.autoSearch&&(e=0,a.on("input",function(){clearTimeout(e),e=setTimeout(function(){c()},500)}))):s.html(l.rowTemplate.compile(l.list,!0))},onsure:function(t){return p?"function"==typeof e?e(p):void 0:(g.warning("没有选择"+l.name+"!"),!1)}}).show(i,l.title)},pickUser:function(t,e,n){return"object"!=_typeof(e)||n||(n=e,e=null),this.pickList({url:o.get_search_url("member"),title:e,name:"会员",searchHolder:"根据会员id或名称，电话来搜索",rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action" style="line-height:30px;">{if @avatar}<img src="{@avatar}" style="width:30px;height:30px;border-radius: 100%;margin-right:10px;" />{else}<i class="ion-md-person"></i>{/if} <div class="flex-info"><div>[{@id}]&nbsp;{if @nickname}{@nickname}{else}{@username}{/if}&nbsp;&nbsp;&nbsp;{if @mobile}<small><i class="ion-md-phone-portrait"></i> {@mobile}</small>{/if}</div><div>{if @level}<small><i class="ion-md-people"></i> {@level.level_name}</small>{/if}&nbsp;{if @agent}<small><i class="ion-md-ribbon"></i> {@agent.name}</small>{/if}</div></div></a>'},t,n)},pickArticle:function(t,e,n){return"object"!=_typeof(e)||n||(n=e,e=null),this.pickList({url:o.get_search_url("article"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @cover}<div style="background-image:url({@cover})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@description}</div></a>',title:e,name:"文章",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("article"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据文章标题搜索"},t,n)},pickProduct:function(t,e,n){"object"!=_typeof(e)||n||(n=e,e=null);var i=n&&n.searchtype?'<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />[{@sku_goods_no}]&nbsp;{@price}</div>':'<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@min_price}{if @max_price>@min_price}~{@max_price}{/if}</div>';return this.pickList({url:o.get_search_url("product"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @image}<div style="background-image:url({@image})" class="imgview" ></div>{/if}'+i+"</a>",title:e,name:"产品",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("product"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据产品名称搜索"},t,n)},pickCategory:function(t,e,n){return this.pickList({title:n,url:o.get_cate_url(e),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action pt-0 pb-0" style="line-height:30px;">{@html}&nbsp;[{@id}]&nbsp;{@title}</a>'},t)},pickLocate:function(s,e,r){var c=null,l=null,t=.6*y(o).height();return s=s||"tencent",new w({size:"lg",backdrop:"static",onshown:function(t){var n=t.find(".searchbtn"),i=t.find(".searchtext"),o=t.find(".map"),a=t.find(".mapinfo");setTimeout(function(){var e=InitMap(s,o,function(t,e,n){a.html(t+"&nbsp;"+e.lng+","+e.lat),c=e,l=n},r);n.click(function(){var t=i.val();e.setLocate(t)}),t.find(".setToCenter").click(function(t){e.showAtCenter()})},500)},onsure:function(t){return c?"function"==typeof e?e(c,l):void 0:(g.warning("没有选择位置!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="填写地址检索位置"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="map mt-2" style="height:'+t+'px"></div><div class="float-right mt-2 mapactions"><a href="javascript:" class="setToCenter">定位到地图中心</a></div><div class="mapinfo mt-2 text-muted">未选择位置</div>',"请选择地图位置")}};y(document).on("keydown",function(t){13==t.keyCode&&(t=y(".shirne-modal").eq(-1))&&!1!==t.data("keyboard")&&t.find(".modal-footer .btn[default]").trigger("click")}),o.Dialog=y.Dialog=w,o.dialog=y.dialog=g,o.createTitle=function(t,e){return'<div class="main-title">'+t+'</div><div class="sub-title">'+e+"</div>"}})(window,jQuery||Zepto),jQuery.extend(jQuery.fn,{tags:function(t,o){var a=[],s='<span class="badge badge-info">{@label}<input type="hidden" name="'+t+'" value="{@label}"/><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></span>',t=$(this).parents(".form-control"),r=$('<span class="badge-group"></span>'),c=this;this.before(r),this.on("keyup",function(){var t=$(this).val().replace(/，/g,","),e=!1;if(t&&-1<t.indexOf(",")){for(var n=t.split(","),i=0;i<n.length;i++)n[i]=n[i].replace(/^\s|\s$/g,""),n[i]&&-1===a.indexOf(n[i])&&(a.push(n[i]),r.append(s.compile({label:n[i]})),e=!0);c.val(""),e&&o&&o(a)}}).on("blur",function(){var t=$(this).val();t&&$(this).val(t+",").trigger("keyup")}).trigger("blur"),r.on("click",".close",function(){var t=$(this).parents(".badge").find("input").val(),t=a.indexOf(t);t&&a.splice(t,1),$(this).parents(".badge").remove(),o&&o(a)}),t.click(function(){c.focus()})}});var tooltips=window.datetimepickerTooltips||{today:"定位当前日期",clear:"清除已选日期",close:"关闭选择器",selectMonth:"选择月份",prevMonth:"上个月",nextMonth:"下个月",selectYear:"选择年份",prevYear:"上一年",nextYear:"下一年",selectDecade:"选择年份区间",selectTime:"选择时间",prevDecade:"上一区间",nextDecade:"下一区间",prevCentury:"上个世纪",nextCentury:"下个世纪"};function datetimeConfig(t){return $.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},transOption($(t).data()))}function daterangeConfig(t){return $.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},transOption($(t).data()))}function radio_tab(t,n,i){$(t).on("change",function(t){var e;$(this).is(":checked")&&(e=$(this).val(),$(n).hide(),$("."+i+e).show())}).filter(":checked").trigger("change")}function editData(t,i,e,n){var o=new Dialog({onshown:function(e){$.fn.datetimepicker&&e.find(".datepicker").each(function(){$(this).datetimepicker({format:"YYYY-MM-DD"})}),0<t&&$.ajax({url:i+"?id="+t,dataType:"JSON",type:"GET",success:function(t){1==t.code&&bindData(e,t.data.model)}})},onsure:function(t){var e={url:i,type:"POST",dataType:"JSON",success:function(t){dialog.alert(t.msg),1==t.code&&(location.reload(),o.close())},error:function(t){dialog.error(t.toString())}},n=t.find("form");return 0<n.length?"multipart/form-data"==n.attr("enctype")?(e.data=new FormData(n[0]),e.cache=!1,e.processData=!1,e.contentType=!1):e.data=$(n).serialize():e.data=getData(t),$.ajax(e),!1}}).show(e,(0<t?"编辑":"添加")+n)}function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}function isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}function bindData(t,e){for(var n in e)if(isObject(e[n]))for(var i in e[n])"radio"==(o=t.find('[name="'+n+"["+i+']"]')).attr("type")?o.each(function(){$(this).val()==e[n][i]&&$(this).prop("checked",!0)}):"checkbox"==o.attr("type")?e[n][i]==$(this).val()&&$(this).prop("checked",!0):o.val(e[n][i]);else{var o,a="";isArray(e[n])&&(a="[]"),"radio"==(o=t.find('[name="'+n+a+'"]')).attr("type")?o.each(function(){$(this).val()==e[n]&&$(this).prop("checked",!0)}):"checkbox"==o.attr("type")?o.each(function(){-1<e[n].indexOf($(this).val())&&$(this).prop("checked",!0)}):o.val(e[n])}}function getData(t){for(var e={},n=t.find("[name]"),i=0;i<n.length;i++){var o,a=n.eq(i),s=a.attr("name");null==e[s]&&("radio"==a.attr("type")?t.find("[name="+s+"]").each(function(){$(this).prop("checked")&&(e[s]=$(this).val())}):"checkbox"==a.attr("type")?(o=[],t.find('[name="'+s+'"]').each(function(){$(this).prop("checked")&&o.push($(this).val())}),e[s]=o):e[s]=a.val())}return e}jQuery(function(i){i.fn.datetimepicker&&(i(".datepicker").each(function(){i(this).datetimepicker(datetimeConfig(this))}),i(".date-range").each(function(){var t=i(this).find("[name=fromdate],.fromdate"),e=i(this).find("[name=todate],.todate"),n=daterangeConfig(this);t.datetimepicker(n).on("dp.change",function(){t.val()&&e.data("DateTimePicker").minDate(t.val())}),e.datetimepicker(n).on("dp.change",function(){e.val()&&t.data("DateTimePicker").maxDate(e.val())})}))}),((o,a)=>{var s,r,c,l={baidu:"//api.map.baidu.com/api?ak=__KEY__&v=1.5&services=false&callback=",google:"//maps.google.com/maps/api/js?key=__KEY__&callback=",tencent:"//map.qq.com/api/js?v=2.exp&key=__KEY__&callback=",gaode:"//webapi.amap.com/maps?v=1.3&key=__KEY__&callback="};function t(t){if(void 0!==t){var e="MAPKEY_"+t.toUpperCase();if(!o[e])throw"Pls define the "+e+" on window.";this.mapkey=o[e],this.mapType=t,this.ishide=!1,this.isshow=!1,this.toshow=!1,this.marker=null,this.infoWindow=null,this.mapbox=null,this.locate=null,this.map=null}}function d(){t.call(this,"baidu")}function p(){t.call(this,"google"),this.infoOpts={width:250,title:""}}function u(){t.call(this,"tencent")}function h(){t.call(this,"gaode"),this.infoOpts={width:250,title:""}}t.prototype.isAPIReady=function(){return!1},t.prototype.pointToObject=function(){},t.prototype.objectToPoint=function(){},t.prototype.setMap=function(){},t.prototype.showInfo=function(){},t.prototype.getCenter=function(){},t.prototype.getAddress=function(t){return""},t.prototype.getAddressComponent=function(t){return{}},t.prototype.setLocate=function(t){},t.prototype.loadAPI=function(){var t,e,n,i=this;return this.isAPIReady()?(this.mapbox=a("#"+this.mapType+"map"),this.mapbox.length<1&&(this.mapbox=a('<div id="'+this.mapType+'map" class="mapbox"></div>'),r.append(this.mapbox)),!0):(this.mapbox=a('<div id="'+this.mapType+'map" class="mapbox">loading...</div>'),r.append(this.mapbox),t="mapload"+(new Date).getTime(),o[t]=function(){i.setMap(),delete o[t]},e=l[this.mapType].replace("__KEY__",this.mapkey),e=e+t,(n=document.createElement("script")).type="text/javascript",n.src=e,document.body.appendChild(n),!1)},t.prototype.setInfoContent=function(){var t,e;this.infoWindow&&(t="<b>当前位置</b>",e='<p style="line-height:1.6em;"></p>',this.infoWindow.setTitle?(this.infoWindow.setTitle(t),this.infoWindow.setContent(e)):this.infoWindow.setContent('<h3><b>当前位置</b></h3><div style="width:250px"><p style="line-height:1.6em;"></p></div>'))},t.prototype.showAtCenter=function(){var t=this.getCenter();this.showInfo(t)},t.prototype.showLocationInfo=function(t,e){this.showInfo();var n=this.getAddress(e),e=this.getAddressComponent(e),i={};"function"==typeof t.lng?(i.lng=t.lng(),i.lat=t.lat()):(i.lng=t.lng,i.lat=t.lat),c(n,i,e)},t.prototype.show=function(){this.ishide=!1,this.setMap(),this.showInfo()},t.prototype.hide=function(){this.ishide=!0,this.infoWindow&&this.infoWindow.close(),this.mapbox&&a(this.mapbox).remove()},((d.prototype=new t).constructor=d).prototype.isAPIReady=function(){return!!o.BMap},d.prototype.setMap=function(){var t,e,n,i=this;this.isshow||this.ishide||this.loadAPI()&&((t=i.map=new BMap.Map(this.mapbox.attr("id"))).addControl(new BMap.NavigationControl),t.addControl(new BMap.ScaleControl),t.addControl(new BMap.OverviewMapControl),t.enableScrollWheelZoom(),this.locate||(this.locate=this.getCenter()),e=this.objectToPoint(this.locate),t.centerAndZoom(e,15),this.marker=new BMap.Marker(e),this.marker.enableDragging(),n=new BMap.Geocoder,this.marker.addEventListener("dragend",function(e){n.getLocation(e.point,function(t){i.showLocationInfo(e.point,t)})}),this.marker.addEventListener("click",function(e){n.getLocation(e.point,function(t){i.showLocationInfo(e.point,t)})}),t.addOverlay(this.marker),n.getLocation(e,function(t){i.showLocationInfo(e,t)}),this.infoWindow=new BMap.InfoWindow("",{width:250,title:""}),this.isshow=!0,this.toshow)&&(this.showInfo(),this.toshow=!1)},d.prototype.pointToObject=function(t){return{lng:t.lng,lat:t.lat}},d.prototype.objectToPoint=function(t){return new BMap.Point(parseFloat(t.lng),parseFloat(t.lat))},d.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},d.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.panTo(new BMap.Point(t.lng,t.lat))),this.setInfoContent(),this.marker.openInfoWindow(this.infoWindow)):this.toshow=!0)},d.prototype.getAddress=function(t){t=t.addressComponents;if(t)return t.province+", "+t.city+", "+t.district+", "+t.street+", "+t.streetNumber},d.prototype.getAddressComponent=function(t){return t.addressComponents},d.prototype.setLocate=function(t){var n=new BMap.Geocoder,i=this;n.getPoint(t,function(e){e?(i.map.centerAndZoom(e,11),i.marker.setPosition(e),n.getLocation(e,function(t){i.showLocationInfo(e,t)})):alert("地址信息不正确，定位失败")},"")},((p.prototype=new t).constructor=p).prototype.isAPIReady=function(){return o.google&&o.google.maps},p.prototype.setMap=function(){var t,e,n,i=this;this.isshow||this.ishide||!this.loadAPI()||this.mapbox.length<1||(t=i.map=new google.maps.Map(this.mapbox[0],{zoom:15,draggable:!0,scaleControl:!0,streetViewControl:!0,zoomControl:!0}),this.locate||(this.locate=this.getCenter()),e=this.objectToPoint(this.locate),t.panTo(e),this.marker=new google.maps.Marker({position:e,map:t,draggable:!0}),n=new google.maps.Geocoder,this.marker.addListener("dragend",function(){e=i.marker.getPosition(),n.geocode({location:e},function(t){i.showLocationInfo(e,t)})}),this.marker.addListener("click",function(){e=i.marker.getPosition(),n.geocode({location:e},function(t){i.showLocationInfo(e,t)})}),n.geocode({location:e},function(t){i.showLocationInfo(e,t)}),this.infoWindow=new google.maps.InfoWindow({map:t}),this.infoWindow.setPosition(e),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1))},p.prototype.pointToObject=function(t){return{lng:t.lng,lat:t.lat}},p.prototype.objectToPoint=function(t){return new google.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng))},p.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},p.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.setPosition(this.objectToPoint(t))),this.infoWindow.setOptions({position:this.marker.getPosition()}),this.setInfoContent()):this.toshow=!0)},p.prototype.getAddress=function(t,e){if(t&&t[0])return t[0].formatted_address},p.prototype.getAddressComponent=function(t,e){var n={};return t&&t[0]&&((t=t[0].address_components)[0]&&(n.country=t[0].long_name),t[1]&&(n.province=t[1].long_name),t[2]&&(n.city=t[2].long_name),t[3]&&(n.district=t[3].long_name),t[4]&&(n.street=t[4].long_name),t[5])&&(n.address=t[5].long_name),n},p.prototype.setLocate=function(t){var n=new google.maps.Geocoder,i=this;n.getPoint(t,function(e){e?(i.map.centerAndZoom(e,11),i.marker.setPosition(e),n.getLocation(e,function(t){i.showLocationInfo(e,t)})):alert("地址信息不正确，定位失败")},"")},((u.prototype=new t).constructor=u).prototype.isAPIReady=function(){return o.qq&&o.qq.maps},u.prototype.pointToObject=function(t){return{lng:t.getLng(),lat:t.getLat()}},u.prototype.objectToPoint=function(t){return new qq.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng))},u.prototype.setMap=function(){var t,e,n,i=this;this.isshow||this.ishide||this.loadAPI()&&(t=i.map=new qq.maps.Map(this.mapbox[0],{zoom:15}),new qq.maps.ScaleControl({align:qq.maps.ALIGN.BOTTOM_LEFT,margin:qq.maps.Size(85,15),map:t}),this.locate||(this.locate=this.getCenter()),e=this.objectToPoint(this.locate),t.panTo(e),this.marker=new qq.maps.Marker({position:e,draggable:!0,map:t}),this.marker.setAnimation(qq.maps.MarkerAnimation.DOWN),n=new qq.maps.Geocoder({complete:function(t){i.showLocationInfo(e,t)}}),qq.maps.event.addListener(this.marker,"click",function(){e=i.marker.getPosition(),n.getAddress(e)}),qq.maps.event.addListener(this.marker,"dragend",function(){e=i.marker.getPosition(),n.getAddress(e)}),n.getAddress(e),this.infoWindow=new qq.maps.InfoWindow({map:t}),this.isshow=!0,this.toshow)&&(this.showInfo(),this.toshow=!1)},u.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},u.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.setPosition(this.objectToPoint(t))),this.infoWindow.setPosition(this.marker.getPosition()),this.infoWindow.open(),this.setInfoContent()):this.toshow=!0)},u.prototype.getAddress=function(t){return t&&t.detail?t.detail.address:""},u.prototype.getAddressComponent=function(t){return t&&t.detail?((t=t.detail.addressComponents).province||(t.province=t.city),t.streetNumber&&(t.address=t.streetNumber),t):{}},u.prototype.setLocate=function(t){var n=this;new qq.maps.Geocoder({complete:function(t){var e;t&&t.detail&&t.detail.location?(e=t.detail.location,n.map.setCenter(e),n.marker.setPosition(e),n.showLocationInfo(e,t)):alert("地址信息不正确，定位失败")},error:function(t){alert("地址信息不正确，定位失败")}}).getLocation(t)},((h.prototype=new t).constructor=h).prototype.isAPIReady=function(){return!!o.AMap},h.prototype.setMap=function(){var e,n,i=this;this.isshow||this.ishide||this.loadAPI()&&((e=i.map=new AMap.Map(this.mapbox.attr("id"),{resizeEnable:!0,dragEnable:!0,zoom:13})).plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView"],function(){e.addControl(new AMap.ToolBar),e.addControl(new AMap.Scale),e.addControl(new AMap.OverView)}),a("[name=txtLang]").unbind().on("change",function(){var t=a(this).val();t&&e.setLang(t)}).trigger("change"),this.locate||(this.locate=this.getCenter()),n=this.objectToPoint(this.locate),e.setCenter(n),this.marker=new AMap.Marker({position:n,map:e}),this.marker.setDraggable(!0),this.infoWindow=new AMap.InfoWindow,this.infoWindow.open(e,n),e.plugin(["AMap.Geocoder"],function(){var t=new AMap.Geocoder;i.marker.on("dragend",function(n){t.getAddress(n.lnglat,function(t,e){i.showLocationInfo(n.lnglat,e)})}),i.marker.on("click",function(n){t.getAddress(n.lnglat,function(t,e){i.showLocationInfo(n.lnglat,e)})}),t.getAddress(n,function(t,e){i.showLocationInfo(n,e)})}),this.isshow=!0,this.toshow)&&(this.showInfo(),this.toshow=!1)},h.prototype.pointToObject=function(t){return{lng:t.getLng(),lat:t.getLat()}},h.prototype.objectToPoint=function(t){return new AMap.LngLat(t.lng,t.lat)},h.prototype.getCenter=function(){var t=this.map.center();return this.pointToObject(t)},h.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&this.marker.setPosition(this.objectToPoint(t)),this.setInfoContent(),this.infoWindow.setPosition(this.marker.getPosition())):this.toshow=!0)},h.prototype.getAddress=function(t){return t.regeocode.formattedAddress},h.prototype.getAddressComponent=function(t){return t.regeocode.addressComponent},h.prototype.setLocate=function(t){var n=new AMap.Geocoder,i=this;n.getPoint(t,function(e){e?(i.map.centerAndZoom(e,11),i.marker.setPosition(e),n.getLocation(e,function(t){i.showLocationInfo(e,t)})):alert("地址信息不正确，定位失败")},"")},o.InitMap=function(t,e,n,i){switch(s&&s.hide(),r=a(e),c=n,t.toLowerCase()){case"baidu":s=new d;break;case"google":s=new p;break;case"tencent":case"qq":s=new u;break;case"gaode":s=new h}return s?(i&&("string"==typeof i&&(e=i.split(","),i={lng:parseFloat(e[0]),lat:parseFloat(e[1])}),s.locate=i),s.setMap(),s):dialog.warning("不支持该地图类型")}})(window,jQuery),window.stop_ajax=!1,String.prototype.toHtmlEntities=function(){return this.replace(/./gm,function(t){return t.match(/[a-z0-9\s]+/i)?t:"&#"+t.charCodeAt(0)+";"})},String.prototype.fromHtmlEntities=function(){return this.replace(/&#\d+;/gm,function(t){return String.fromCharCode(t.match(/\d+/gm)[0])})},jQuery(function(p){var t,e,n=p(".breadcrumb"),i=n.data("menu");i&&(t=[],0<(i=p(".side-nav a[data-key="+i+"]")).length&&(i.is(".menu_top")?t.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+i.find("i").attr("class")+'"></i>&nbsp;'+i.text()+"</a></li>"):((e=i.parents(".collapse").eq(0)).addClass("show"),i.addClass("active"),e=e.siblings(".card-header").find("a.menu_top"),t.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+e.find("i").attr("class")+'"></i>&nbsp;'+e.text()+"</a></li>"),t.push('<li class="breadcrumb-item"><a href="javascript:">'+i.text()+"</a></li>"))),(e=n.data("title"))&&t.push('<li class="breadcrumb-item active" aria-current="page">'+e+"</li>"),n.html(t.join("\n"))),p(window).on("scroll",function(t){}).trigger("scroll"),p(".checkall-btn").click(function(t){var e=p(this).data("target"),e=p("[name="+(e=e||"id")+"]");p(this).is(".active")?e.prop("checked",!1):e.prop("checked",!0)}),p(".checkreverse-btn").click(function(t){for(var e=p(this).data("target"),n=p("[name="+(e=e||"id")+"]"),i=0;i<n.length;i++)n[i].checked?n.eq(i).prop("checked",!1):n.eq(i).prop("checked",!0)}),p(".action-btn").click(function(t){t.preventDefault();t=p(this).data("action");if(!t)return dialog.error("未知操作");if(t="action"+t.replace(/^[a-z]/,function(t){return t.toUpperCase()}),!window[t]||"function"!=typeof window[t])return dialog.error("未知操作");var e=p(this).data("need-checks");if(e=void 0===e?!0:e){var e=p(this).data("target"),n=p("[name="+(e=e||"id")+"]:checked");if(n.length<1)return dialog.warning("请选择需要操作的项目");for(var i=[],o=0;o<n.length;o++)i.push(n.eq(o).val());window[t].call(this,i)}else window[t].call(this)}),p(".radiostatus").click(function(t){var e=p(this).data("init"),n=p(this).find("input"),i=n.data("open"),o=n.data("close"),a=n.val();e?n.val(a="1"==a?0:1):(p(this).data("init",1),p(this).append("<span></span>")),"1"==a?(p(this).find("span").text(i),p(this).prop("title","点击"+o),p(this).removeClass("off")):(p(this).find("span").text(o),p(this).prop("title","点击"+i),p(this).addClass("off"))}).trigger("click"),p(".chgstatus").click(function(t){var n,e,i,o;p(this).data("ajaxing")||(p(this).data("ajaxing",1),i=(e=(n=p(this)).parents("td")).data("id"),o=n.data("status"),p.ajax({url:e.data("url"),type:"POST",dataType:"JSON",data:{id:i,status:o},success:function(t){var e;n.data("ajaxing",0),1==t.code?(dialog.success(t.msg),n.toggleClass("off"),e=n.attr("title").replace("点击",""),n.text(e),setTimeout(function(){location.reload()},1e3)):dialog.error(t.msg)}}))}),p(".operations .btn,.has-tooltip").tooltip(),p("a[rel=ajax]").click(function(t){t.preventDefault();var n=p(this),t=p(this).data("title");t=(t=t||p(this).text())||p(this).attr("title"),new Dialog({btns:["确定"],onshow:function(e){p.ajax({url:n.attr("href"),beforeSend:function(t){t.setRequestHeader("X-Requested-With","htmlhttp")},success:function(t){e.html(t)}})}}).show('<p class="loading">'+lang("loading...")+"</p>",t)}),p(".link-confirm").click(function(t){t.preventDefault(),t.stopPropagation();var t=p(this).data("confirm"),e=p(this).attr("href");t=(t=t&&t.replace(/(\\n|\n)+/g,"<br />"))||lang("Confirm operation?");var n=(n=p(this).data("method"))||"GET";dialog.confirm(t,function(){p.ajax({url:e,type:n,dataType:"JSON",success:function(t){dialog.alert(t.msg,function(){1==t.code&&(t.url?location.href=t.url:location.reload())})},error:function(){dialog.alert(lang("Server error."))}})})}),p(".img-view").click(function(t){t.preventDefault(),t.stopPropagation();t=(t=p(this).attr("href"))||p(this).data("img");new Dialog({btns:["确定"]}).show('<a href="'+t+'" class="d-block text-center" target="_blank"><img class="img-fluid" src="'+t+'" /></a><div class="text-muted text-center">点击图片在新页面放大查看</div>',"查看图片")}),p(".nav-tabs a").click(function(t){t.preventDefault(),p(this).tab("show")}),window.fileInputHander=function(){var t,e,n,i,o,a,s,r,c,l,d=p(this);this.files&&this.files[0]&&(e=(t=p(this).parents(".input-group").eq(0)).parents("div").eq(0),(n=p(this).parents(".custom-file").find(".custom-file-label")).data("origtext")||n.data("origtext",n.text()),n.text(p(this).val()),window.URL||window.URL.createObjectURL)&&(i=d[0].files[0],o=i.type&&i.type.match(/(\.|\/)(jpe?g|png|gif|webp)$/),(a=e.find(".figure")).length||(e.append('<figure class="figure">\n                            <img src="/static/images/blank.gif" class="figure-img img-fluid rounded" alt="image">\n                            <figcaption class="figure-caption text-center"></figcaption>\n                        </figure>'),a=e.find(".figure")),o&&(s=a.find("img"),(r=s.data("origurl"))||(r=s.attr("src"),s.data("origurl",r)),void 0===(c=a.find("figcaption")).data("origtext")&&c.data("origtext",c.text()),s.attr("src",window.URL.createObjectURL(i)),c.text(d.val())),(l=t.find("a.cancel")).length||(t.append('<div class="input-group-append"><a href="javascript:" class="btn btn-outline-danger cancel">取消</a></div>'),(l=t.find("a.cancel")).click(function(t){dialog.confirm("取消上传该文件?",function(){d.val(""),n.text(n.data("origtext")),o&&(s.attr("src",r),c.text(c.data("origtext"))),l.parent().remove()})})))},p(".custom-file .custom-file-input").on("change",window.fileInputHander),p(".btn-primary[type=submit]").click(function(t){var e=p(this).parents("form");if(e.is(".noajax"))return!0;var n=this,i="BUTTON"==p(n).prop("tagName").toUpperCase(),o=i?p(n).text():p(n).val(),a={url:p(e).attr("action"),type:"POST",dataType:"JSON",success:function(t){window.stop_ajax=!1,i?p(n).text(o):p(n).val(o),1==t.code?dialog.alert(t.msg,function(){t.url?location.href=t.url:location.reload()}):(dialog.warning(t.msg),p(n).removeAttr("disabled"))},error:function(t){window.stop_ajax=!1,i?p(n).text(o):p(n).val(o),p(n).removeAttr("disabled"),dialog.error("服务器处理错误")}};if("multipart/form-data"===e.attr("enctype")){if(!FormData)return!(window.stop_ajax=!1);a.data=new FormData(e[0]),a.cache=!1,a.processData=!1,a.contentType=!1,a.xhr=function(){var t=p.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){t=Math.floor(t.loaded/t.total*100);p(n).text(o+"  ("+t+"%)")},!1),t}}else a.data=p(e).serialize();t.preventDefault(),p(this).attr("disabled",!0),window.stop_ajax=!0,p.ajax(a)}),p(".pickuser").click(function(t){var e=p(this).parents(".input-group"),n=e.find("[name=member_id]"),i=e.find("[name=member_info]");dialog.pickUser(function(t){n.val(t.id),i.val("["+t.id+"] "+t.username+(t.mobile?" / "+t.mobile:""))},p(this).data("filter"))}),p(".pick-locate").click(function(t){var e=p(this).parents(".input-group").find("input[type=text]");dialog.pickLocate("qq",function(t){e.val(t.lng+","+t.lat)},e.val())})});
//# sourceMappingURL=app.min.js.map
