"use strict";function del(t,e){return dialog.confirm(e,function(){location.href=$(t).attr("href")}),!1}function lang(t){return window.language&&window.language[t]?window.language[t]:t}function randomString(t,e){for(var o="",n=(e=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,i=0;i<t;i++){var a=Math.floor(Math.random()*n);o+=e.substring(a,a+1)}return o}function copy_obj(t){return JSON.parse(JSON.stringify(t))}function isObjectValueEqual(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;var o=Object.getOwnPropertyNames(t),n=Object.getOwnPropertyNames(e);if(o.length!=n.length)return!1;for(var i=0;i<o.length;i++){var a=o[i];if(t[a]!==e[a])return!1}return!0}function array_combine(t,e){for(var o={},n=0;n<t.length&&!(e.length<n+1);n++)o[t[n]]=e[n];return o}function tostring(t){return t&&t.toString?t.toString():""}function callfunc(t,e,o,n){if(o){"string"==typeof o&&(o=o.split(","));var i=o.indexOf("###");0<=i?o[i]=t:o=[t].concat(o)}else o=[t];return window[e]?window[e].apply(n,o):null==t?"":t}function iif(t,e,o){return"0"===t&&(t=0),t?e:o}if(Number.prototype.format=function(t){void 0===t&&(t=2);for(var e=this.toFixed(t).split("."),o=[],n=e[0].split(""),i=n.length,a=0;a<i;a++)0<a&&a%3==0&&o.unshift(","),o.unshift(n[i-a-1]);return o.join("")+(2==e.length?"."+e[1]:"")},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s+|\s+$)/g,"")}),String.prototype.compile=function(r,t){if(t){var e=[];for(var o in r)e.push(this.compile(r[o]));return e.join("\n")}return this.replace(/\{if\s+([^\}]+)\}([\W\w]*){\/if}/g,function(t,e,o){var n;if(n=e.match(/\s+(=+|<|>)\s+/)){n=n[0];var i=e.split(n);0===i[0].indexOf("@")&&(i[0]=r[i[0].replace("@","")]),0===i[1].indexOf("@")&&(i[1]=r[i[1].replace("@","")]);var a=!1;switch(n=n.trim()){case"==":a=i[0]==i[1];break;case"===":a=i[0]===i[1];break;case">":a=i[0]>i[1];break;case"<":a=i[0]<i[1]}if(a)return o}else if(r[e.replace("@","")])return o;return""}).replace(/\{@([\w\d\.]+)(?:\|([\w\d]+)(?:\s*=\s*([^\}]+))?)?\}/g,function(t,e,o,n){if(0<e.indexOf(".")){for(var i=e.split("."),a=r,s=0;s<i.length;s++){if(void 0===a[i[s]]||null===a[i[s]]){a="";break}a=a[i[s]]}return callfunc(a,o,n)}return callfunc(r[e],o,n,r)})},window.default=function(t,e){return t||e},function(c,d){var r='<div class="modal fade" id="{@id}" tabindex="-1" role="dialog" aria-labelledby="{@id}Label" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h4 class="modal-title" id="{@id}Label"></h4>\n                <button type="button" class="close" data-dismiss="modal">\n                    <span aria-hidden="true">&times;</span>\n                    <span class="sr-only">Close</span>\n                </button>\n            </div>\n            <div class="modal-body">\n            </div>\n            <div class="modal-footer">\n                <nav class="nav nav-fill"></nav>\n            </div>\n        </div>\n    </div>\n</div>',o=0;function f(t){if(t||(t={}),t.btns){if("string"==typeof t.btns)t.btns=[{text:t.btns}];else if(t.btns instanceof Array)for(var e=0;e<t.btns.length;e++)"string"==typeof t.btns[e]&&(t.btns[e]={text:t.btns[e]}),t.btns[e].isdefault&&(t.defaultBtn=e);else console.error("Dialog::construct argument btns error."),t.btns=[];0<t.btns.length&&(void 0===t.defaultBtn&&(t.defaultBtn=t.btns.length-1,t.btns[t.defaultBtn].isdefault=!0),t.btns[t.defaultBtn]&&!t.btns[t.defaultBtn].type&&(t.btns[t.defaultBtn].type="primary"))}this.options=d.extend({id:"modal_dialog_"+o++,header:!0,footer:!0,backdrop:!0,size:"",btns:[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}],defaultBtn:1,contentClass:"",onsure:null,onshow:null,onshown:null,onhide:null,onhidden:null},t),(!this.options.btns||this.options.btns.length<1)&&(this.options.footer=!1),this.closed=!0,this.box=d(this.options.id)}f.prototype.generBtn=function(t,e){return t.type&&(t.class="btn-outline-"+t.type),'<a href="javascript:" class="nav-item btn '+(t.class?t.class:"btn-outline-secondary")+'" data-index="'+e+'">'+t.text+"</a>"},f.prototype.show=function(t,e){this.box=d("#"+this.options.id),e||(e="系统提示"),this.box.length<1?(d(document.body).append(r.replace("modal-body","modal-body"+(this.options.bodyClass?" "+this.options.bodyClass:"")).compile({id:this.options.id})),this.box=d("#"+this.options.id)):this.box.unbind(),this.options.header||this.box.find(".modal-header").remove(),this.options.footer||this.box.find(".modal-footer").remove(),!0!==this.options.backdrop&&(this.box.data("backdrop",this.options.backdrop),!1===this.options.backdrop&&this.box.css({height:0,overflow:"visible"})),this.options.keyboard||this.box.data("keyboard",!1);var o=this;f.instance=o;for(var n=[],i=0;i<this.options.btns.length;i++)n.push(this.generBtn(this.options.btns[i],i));this.box.find(".modal-footer .nav").html(n.join("\n"));var a=this.box.find(".modal-dialog");a.removeClass("modal-sm").removeClass("modal-lg"),"sm"==this.options.size?a.addClass("modal-sm"):"lg"==this.options.size&&a.addClass("modal-lg"),this.options.contentClass&&a.find(".modal-content").addClass(this.options.contentClass),this.box.find(".modal-title").text(e);var s=this.box.find(".modal-body");return s.html(t),this.box.on("hide.bs.modal",function(){o.options.onhide&&o.options.onhide(s,o.box),f.instance=null}),this.box.on("hidden.bs.modal",function(){o.options.onhidden&&o.options.onhidden(s,o.box),o.closed=!0,o.box.remove(),o.box=null}),this.box.on("show.bs.modal",function(){o.options.onshow&&o.options.onshow(s,o.box)}),this.box.on("shown.bs.modal",function(){o.options.onshown&&o.options.onshown(s,o.box)}),this.options.footer&&this.box.find(".modal-footer .btn").click(function(){var t=!0,e=d(this).data("index");o.options.btns[e].click&&(t=o.options.btns[e].click.apply(this,[s,o.box])),e==o.options.defaultBtn&&o.options.onsure&&(t=o.options.onsure.apply(this,[s,o.box])),!1!==t&&o.box.modal("hide")}),this.closed=!1,this.box.modal("show"),this},f.prototype.hide=f.prototype.close=function(){return this.box&&!this.closed&&(this.closed=!0,this.box.modal("hide")),this};var n={error:function(t,e){return this.message(t,"error",e)},success:function(t,e){return this.message(t,"success",e)},warning:function(t,e){return this.message(t,"warning",e)},info:function(t,e){return this.message(t,"info",e)},message:function(t,e,o){var n="bg-info text-white",i="information-circle";if(e)switch(e){case"danger":case"error":i="close-circle",n="bg-danger text-white";break;case"warning":i="warning",n="bg-warning text-white";break;case"success":i="checkmark-circle",n="bg-success text-white"}var a='<div class="dialog-message" ><i class="ion-md-'+i+'"></i>&nbsp;&nbsp;'+t+'<a href="javascript:" class="ion-md-close closebtn"></a></div>',s=new f({footer:!1,header:!1,backdrop:!1,size:"sm",contentClass:n,onshow:function(t){t.find(".closebtn").click(function(){s.close()})}}).show(a,"");return o||(o=2),setTimeout(function(){s.close()},1e3*o),s},alert:function(t,e,o){var n=!1,i="function"==typeof e,a="",s="sm",r="";if(void 0===e||i||(o=e),d.isPlainObject(t)){if(t.title&&(a=t.title),void 0!==t.size&&(s=t.size),void 0===t.content)throw"message.content can not be empty.";t=t.content}var c={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},l="primary";return void 0===o?o="information-circle":c[o]&&(l="error"==o?"danger":o,o=c[o]),r=o?'<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:o,color:l}):t,new f({btns:"确定",size:s,header:!!a,onsure:function(){if(i)return e(n=!0)},onhide:function(){!n&&i&&e(!1)}}).show(r,a)},confirm:function(t,e,o,n,i){var a=!1;"function"!=typeof e?(n=e,"function"==typeof o?(e=o,o=null):i=o):"function"!=typeof o&&(i=n,n=o),"number"==typeof n&&(i=n,n=void 0);var s={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},r="primary";n?s[n]&&(r="error"===n?"danger":n,n=s[n]):n="information-circle";var c='<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:n,color:r}),l=0,d=new f({header:!1,size:"sm",backdrop:"static",onsure:function(){if(e&&"function"==typeof e)return a=!0,e()},onhide:function(){if(clearInterval(l),!1===a&&"function"==typeof o)return o()}}).show(c);if(i&&"number"==typeof i){var p=d.box.find(".modal-footer .btn-outline-primary"),h=d.options.btns[d.options.defaultBtn].text;p.addClass("disabled").text(h+"("+i+")"),l=setInterval(function(){0<--i?p.text(h+"("+i+")"):(p.text(h),p.removeClass("disabled"),clearInterval(l))},1e3)}return d},prompt:function(e,n,t){var o='<div class="form-group">{@input}</div>',i="请输入信息";return"string"==typeof e?i=e:(i=e.title,e.content&&(o=-1<e.content.indexOf("{@input}")?e.content:e.content+o)),new f({backdrop:"static",onshow:function(t){e&&e.onshow&&e.onshow(t)},onshown:function(t){t.find("[name=confirm_input]").focus(),e&&e.onshown&&e.onshown(t)},onsure:function(t){var e=t.find("[name=confirm_input]").val();if("function"==typeof n){var o=n(e);return!0===o&&!0,o}},onhide:function(){if(!1)return t()}}).show(o.compile({input:'<input type="text" name="confirm_input" class="form-control" />'}),i)},action:function(t,o,e){var n='<div class="list-group"><a href="javascript:" class="list-group-item list-group-item-action">'+t.join('</a><a href="javascript:" class="list-group-item list-group-item-action">')+"</a></div>",i=null,a=new f({bodyClass:"modal-action",backdrop:"static",size:"sm",btns:[{text:"取消",type:"secondary"}],onshow:function(t){(i=t.find(".list-group-item-action")).click(function(t){i.removeClass("active"),d(this).addClass("active");var e=i.index(this);"function"==typeof o?!1!==o(e)&&a.close():a.close()})},onsure:function(t){return!0},onhide:function(){return!0}}).show(n,e||"请选择")},pickList:function(s,e,r){"string"==typeof s&&(s={url:s}),s=d.extend({url:"",name:"对象",searchHolder:"根据名称搜索",idkey:"id",onRow:null,extend:null,rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">[{@id}]&nbsp;<i class="ion-md-person"></i> {@username}&nbsp;&nbsp;&nbsp;<small><i class="ion-md-phone-portrait"></i> {@mobile}</small></a>'},s||{});var c=null,t="";s.extend&&(t='<select name="'+s.extend.name+'" class="form-control"><option value="">'+s.extend.title+"</option></select>"),r||(r={});new f({backdrop:"static",onshown:function(t){var e=t.find(".searchbtn"),o=t.find(".searchtext"),n=t.find(".list-group"),i=!1,a=null;s.extend&&(a=t.find("[name="+s.extend.name+"]"),d.ajax({url:s.extend.url,type:"GET",dataType:"JSON",success:function(t){a.append(s.extend.htmlRow.compile(t.data,!0))}})),e.click(function(){i||(i=!0,n.html('<span class="list-loading">加载中...</span>'),r.key=o.val(),s.extend&&(r[s.extend.name]=a.val()),d.ajax({url:s.url,type:"GET",dataType:"JSON",data:r,success:function(o){i=!1,1===o.code?o.data&&o.data.length?(n.html(s.rowTemplate.compile(o.data,!0)),n.find("a.list-group-item").click(function(){for(var t=d(this).data("id"),e=0;e<o.data.length;e++)if(o.data[e][s.idkey]==t){c=o.data[e],n.find("a.list-group-item").removeClass("active"),d(this).addClass("active");break}})):n.html('<span class="list-loading"><i class="ion-md-warning"></i> 没有检索到'+s.name+"</span>"):n.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>')}}))}).trigger("click")},onsure:function(t){return c?"function"==typeof e?e(c):void 0:(n.warning("没有选择"+s.name+"!"),!1)}}).show('<div class="input-group">'+t+'<input type="text" class="form-control searchtext" name="keyword" placeholder="'+s.searchHolder+'"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="list-group list-group-picker mt-2"></div>',"请搜索并选择"+s.name)},pickUser:function(t,e){return this.pickList({url:c.get_search_url("member"),name:"会员",searchHolder:"根据会员id或名称，电话来搜索"},t,e)},pickArticle:function(t,e){return this.pickList({url:c.get_search_url("article"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @cover}<div style="background-image:url({@cover})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@description}</div></a>',name:"文章",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("article"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据文章标题搜索"},t,e)},pickProduct:function(t,e){return this.pickList({url:c.get_search_url("product"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @image}<div style="background-image:url({@image})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@min_price}~{@max_price}</div></a>',name:"产品",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("product"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据产品名称搜索"},t,e)},pickLocate:function(t,e,s){var r=null;new f({size:"lg",backdrop:"static",onshown:function(t){var e=t.find(".searchbtn"),o=t.find(".searchtext"),n=t.find(".map"),i=t.find(".mapinfo");n.css("height",.6*d(c).height());var a=InitMap("tencent",n,function(t,e){i.html(t+"&nbsp;"+e.lng+","+e.lat),r=e},s);e.click(function(){var t=o.val();a.setLocate(t)}),t.find(".setToCenter").click(function(t){a.showAtCenter()})},onsure:function(t){return r?"function"==typeof e?e(r):void 0:(n.warning("没有选择位置!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="填写地址检索位置"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="map mt-2"></div><div class="float-right mt-2 mapactions"><a href="javascript:" class="setToCenter">定位到地图中心</a></div><div class="mapinfo mt-2 text-muted">未选择位置</div>',"请选择地图位置")}};d(document).on("keydown",function(t){if(f.instance){var e=f.instance;13==t.keyCode&&e.box.find(".modal-footer .btn").eq(e.options.defaultBtn).trigger("click")}}),c.Dialog=d.Dialog=f,c.dialog=d.dialog=n}(window,jQuery||Zepto),jQuery.extend(jQuery.fn,{tags:function(t,i){var a=[],s='<span class="badge badge-info">{@label}<input type="hidden" name="'+t+'" value="{@label}"/><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></span>',e=$(this).parents(".form-control"),r=$('<span class="badge-group"></span>'),c=this;this.before(r),this.on("keyup",function(){var t=$(this).val().replace(/，/g,","),e=!1;if(t&&-1<t.indexOf(",")){for(var o=t.split(","),n=0;n<o.length;n++)o[n]=o[n].replace(/^\s|\s$/g,""),o[n]&&-1===a.indexOf(o[n])&&(a.push(o[n]),r.append(s.compile({label:o[n]})),e=!0);c.val(""),e&&i&&i(a)}}).on("blur",function(){var t=$(this).val();t&&$(this).val(t+",").trigger("keyup")}).trigger("blur"),r.on("click",".close",function(){var t=$(this).parents(".badge").find("input").val(),e=a.indexOf(t);e&&a.splice(e,1),$(this).parents(".badge").remove(),i&&i(a)}),e.click(function(){c.focus()})}}),$.fn.datetimepicker){var transOption=function(t){if(!t)return{};var e={};for(var o in t)switch(o){case"viewmode":e.viewMode=t[o];break;case"keepopen":e.keepOpen=t[o];break;default:e[o]=t[o]}return e},tooltips={today:"定位当前日期",clear:"清除已选日期",close:"关闭选择器",selectMonth:"选择月份",prevMonth:"上个月",nextMonth:"下个月",selectYear:"选择年份",prevYear:"上一年",nextYear:"下一年",selectDecade:"选择年份区间",selectTime:"选择时间",prevDecade:"上一区间",nextDecade:"下一区间",prevCentury:"上个世纪",nextCentury:"下个世纪"};$(".datepicker").each(function(){var t=$.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},transOption($(this).data()));$(this).datetimepicker(t)}),$(".date-range").each(function(){var t=$(this).find("[name=fromdate],.fromdate"),e=$(this).find("[name=todate],.todate"),o=$.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},$(this).data());t.datetimepicker(o).on("dp.change",function(){t.val()&&e.data("DateTimePicker").minDate(t.val())}),e.datetimepicker(o).on("dp.change",function(){e.val()&&t.data("DateTimePicker").maxDate(e.val())})})}function radio_tab(t,o,n){$(t).on("change",function(t){if($(this).is(":checked")){var e=$(this).val();$(o).hide(),$("."+n+e).show()}}).filter(":checked").trigger("change")}function bindData(t,e){for(var o in e)t.find("[name="+o+"]").val(e[o])}function getData(t){for(var e={},o=t.find("[name]"),n=0;n<o.length;n++)e[o.eq(n).attr("name")]=o.eq(n).val();return e}!function(a,s){var r,c,l,d={baidu:"//api.map.baidu.com/api?ak=__KEY__&v=1.5&services=false&callback=",google:"//maps.google.com/maps/api/js?key=__KEY__&callback=",tencent:"//map.qq.com/api/js?v=2.exp&key=__KEY__&callback=",gaode:"//webapi.amap.com/maps?v=1.3&key=__KEY__&callback="};function t(t){if(void 0!==t){var e="MAPKEY_"+t.toUpperCase();if(!a[e])throw"Pls define the "+e+" on window.";this.mapkey=a[e],this.mapType=t,this.ishide=!1,this.isshow=!1,this.toshow=!1,this.marker=null,this.infoWindow=null,this.mapbox=null,this.locate={lng:116.396795,lat:39.933084},this.map=null}}function p(){t.call(this,"baidu")}function h(){t.call(this,"google"),this.infoOpts={width:250,title:""}}function f(){t.call(this,"tencent")}function u(){t.call(this,"gaode"),this.infoOpts={width:250,title:""}}t.prototype.isAPIReady=function(){return!1},t.prototype.pointToObject=function(){},t.prototype.objectToPoint=function(){},t.prototype.setMap=function(){},t.prototype.showInfo=function(){},t.prototype.getCenter=function(){},t.prototype.getAddress=function(t){return""},t.prototype.setLocate=function(t){},t.prototype.loadAPI=function(){var t=this;if(this.isAPIReady())return this.mapbox=s("#"+this.mapType+"map"),this.mapbox.length<1&&(this.mapbox=s('<div id="'+this.mapType+'map" class="mapbox"></div>'),c.append(this.mapbox)),!0;this.mapbox=s('<div id="'+this.mapType+'map" class="mapbox">loading...</div>'),c.append(this.mapbox);var e="mapload"+(new Date).getTime();a[e]=function(){t.setMap(),delete a[e]};var o,n,i=d[this.mapType].replace("__KEY__",this.mapkey);return o=i+e,(n=document.createElement("script")).type="text/javascript",n.src=o,document.body.appendChild(n),!1},t.prototype.setInfoContent=function(){if(this.infoWindow){var t="<b>当前位置</b>",e='<p style="line-height:1.6em;"></p>';if(this.infoWindow.setTitle)this.infoWindow.setTitle(t),this.infoWindow.setContent(e);else{this.infoWindow.setContent('<h3><b>当前位置</b></h3><div style="width:250px"><p style="line-height:1.6em;"></p></div>')}}},t.prototype.showAtCenter=function(){var t=this.getCenter();this.showInfo(t)},t.prototype.showLocationInfo=function(t,e){this.showInfo();var o=this.getAddress(e),n={};"function"==typeof t.lng?(n.lng=t.lng(),n.lat=t.lat()):(n.lng=t.lng,n.lat=t.lat),l(o,n)},t.prototype.show=function(){this.ishide=!1,this.setMap(),this.showInfo()},t.prototype.hide=function(){this.ishide=!0,this.infoWindow&&this.infoWindow.close(),this.mapbox&&s(this.mapbox).remove()},((p.prototype=new t).constructor=p).prototype.isAPIReady=function(){return!!a.BMap},p.prototype.setMap=function(){var o=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var t=o.map=new BMap.Map(this.mapbox.attr("id"));t.addControl(new BMap.NavigationControl),t.addControl(new BMap.ScaleControl),t.addControl(new BMap.OverviewMapControl),t.enableScrollWheelZoom();var e=this.objectToPoint(this.locate);t.centerAndZoom(e,15),this.marker=new BMap.Marker(e),this.marker.enableDragging();var n=new BMap.Geocoder;this.marker.addEventListener("dragend",function(e){n.getLocation(e.point,function(t){o.showLocationInfo(e.point,t)})}),this.marker.addEventListener("click",function(e){n.getLocation(e.point,function(t){o.showLocationInfo(e.point,t)})}),t.addOverlay(this.marker),n.getLocation(e,function(t){o.showLocationInfo(e,t)}),this.infoWindow=new BMap.InfoWindow("",{width:250,title:""}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},p.prototype.pointToObject=function(t){return{lng:t.lng,lat:t.lat}},p.prototype.objectToPoint=function(t){return new BMap.Point(parseFloat(t.lng),parseFloat(t.lat))},p.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},p.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.panTo(new BMap.Point(t.lng,t.lat))),this.setInfoContent(),this.marker.openInfoWindow(this.infoWindow)):this.toshow=!0)},p.prototype.getAddress=function(t){var e=t.addressComponents;if(e)return e.province+", "+e.city+", "+e.district+", "+e.street+", "+e.streetNumber},p.prototype.setLocate=function(t){var o=new BMap.Geocoder,n=this;o.getPoint(t,function(e){e?(n.map.centerAndZoom(e,11),n.marker.setPosition(e),o.getLocation(e,function(t){n.showLocationInfo(e,t)})):alert("地址信息不正确，定位失败")},"")},((h.prototype=new t).constructor=h).prototype.isAPIReady=function(){return a.google&&a.google.maps},h.prototype.setMap=function(){var e=this;if(!this.isshow&&!this.ishide&&this.loadAPI()&&!(this.mapbox.length<1)){var t=e.map=new google.maps.Map(this.mapbox[0],{zoom:15,draggable:!0,scaleControl:!0,streetViewControl:!0,zoomControl:!0}),o=this.objectToPoint(this.locate);t.panTo(o),this.marker=new google.maps.Marker({position:o,map:t,draggable:!0});var n=new google.maps.Geocoder;this.marker.addListener("dragend",function(){o=e.marker.getPosition(),n.geocode({location:o},function(t){e.showLocationInfo(o,t)})}),this.marker.addListener("click",function(){o=e.marker.getPosition(),n.geocode({location:o},function(t){e.showLocationInfo(o,t)})}),n.geocode({location:o},function(t){e.showLocationInfo(o,t)}),this.infoWindow=new google.maps.InfoWindow({map:t}),this.infoWindow.setPosition(o),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},h.prototype.pointToObject=function(t){return{lng:t.lng,lat:t.lat}},h.prototype.objectToPoint=function(t){return new google.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng))},h.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},h.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.setPosition(this.objectToPoint(t))),this.infoWindow.setOptions({position:this.marker.getPosition()}),this.setInfoContent()):this.toshow=!0)},h.prototype.getAddress=function(t,e){if(t&&t[0])return t[0].formatted_address},h.prototype.setLocate=function(t){var o=new google.maps.Geocoder,n=this;o.getPoint(t,function(e){e?(n.map.centerAndZoom(e,11),n.marker.setPosition(e),o.getLocation(e,function(t){n.showLocationInfo(e,t)})):alert("地址信息不正确，定位失败")},"")},((f.prototype=new t).constructor=f).prototype.isAPIReady=function(){return a.qq&&a.qq.maps},f.prototype.pointToObject=function(t){return{lng:t.getLng(),lat:t.getLat()}},f.prototype.objectToPoint=function(t){return new qq.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng))},f.prototype.setMap=function(){var e=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var t=e.map=new qq.maps.Map(this.mapbox[0],{zoom:15});new qq.maps.ScaleControl({align:qq.maps.ALIGN.BOTTOM_LEFT,margin:qq.maps.Size(85,15),map:t});var o=this.objectToPoint(this.locate);t.panTo(o),this.marker=new qq.maps.Marker({position:o,draggable:!0,map:t}),this.marker.setAnimation(qq.maps.MarkerAnimation.DOWN);var n=new qq.maps.Geocoder({complete:function(t){e.showLocationInfo(o,t)}});qq.maps.event.addListener(this.marker,"click",function(){o=e.marker.getPosition(),n.getAddress(o)}),qq.maps.event.addListener(this.marker,"dragend",function(){o=e.marker.getPosition(),n.getAddress(o)}),n.getAddress(o),this.infoWindow=new qq.maps.InfoWindow({map:t}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},f.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},f.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.setPosition(this.objectToPoint(t))),this.infoWindow.setPosition(this.marker.getPosition()),this.infoWindow.open(),this.setInfoContent()):this.toshow=!0)},f.prototype.getAddress=function(t){if(t&&t.detail)return t.detail.address},f.prototype.setLocate=function(t){var o=this;new qq.maps.Geocoder({complete:function(t){if(t&&t.detail&&t.detail.location){var e=t.detail.location;o.map.setCenter(e),o.marker.setPosition(e),o.showLocationInfo(e,t)}else alert("地址信息不正确，定位失败")},error:function(t){alert("地址信息不正确，定位失败")}}).getLocation(t)},((u.prototype=new t).constructor=u).prototype.isAPIReady=function(){return!!a.AMap},u.prototype.setMap=function(){var n=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var e=n.map=new AMap.Map(this.mapbox.attr("id"),{resizeEnable:!0,dragEnable:!0,zoom:13});e.plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView"],function(){e.addControl(new AMap.ToolBar),e.addControl(new AMap.Scale),e.addControl(new AMap.OverView)}),s("[name=txtLang]").unbind().on("change",function(){var t=s(this).val();t&&e.setLang(t)}).trigger("change");var o=this.objectToPoint(this.locate);e.setCenter(o),this.marker=new AMap.Marker({position:o,map:e}),this.marker.setDraggable(!0),this.infoWindow=new AMap.InfoWindow,this.infoWindow.open(e,o),e.plugin(["AMap.Geocoder"],function(){var t=new AMap.Geocoder;n.marker.on("dragend",function(o){t.getAddress(o.lnglat,function(t,e){n.showLocationInfo(o.lnglat,e)})}),n.marker.on("click",function(o){t.getAddress(o.lnglat,function(t,e){n.showLocationInfo(o.lnglat,e)})}),t.getAddress(o,function(t,e){n.showLocationInfo(o,e)})}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},u.prototype.pointToObject=function(t){return{lng:t.getLng(),lat:t.getLat()}},u.prototype.objectToPoint=function(t){return new AMap.LngLat(t.lng,t.lat)},u.prototype.getCenter=function(){var t=this.map.center();return this.pointToObject(t)},u.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&this.marker.setPosition(this.objectToPoint(t)),this.setInfoContent(),this.infoWindow.setPosition(this.marker.getPosition())):this.toshow=!0)},u.prototype.getAddress=function(t){return t.regeocode.formattedAddress},u.prototype.setLocate=function(t){var o=new AMap.Geocoder,n=this;o.getPoint(t,function(e){e?(n.map.centerAndZoom(e,11),n.marker.setPosition(e),o.getLocation(e,function(t){n.showLocationInfo(e,t)})):alert("地址信息不正确，定位失败")},"")},a.InitMap=function(t,e,o,n){switch(r&&r.hide(),c=s(e),l=o,t.toLowerCase()){case"baidu":r=new p;break;case"google":r=new h;break;case"tencent":case"qq":r=new f;break;case"gaode":r=new u}if(!r)return dialog.warning("不支持该地图类型");if(n){if("string"==typeof n){var i=n.split(",");n={lng:parseFloat(i[0]),lat:parseFloat(i[1])}}r.locate=n}return r.setMap(),r}}(window,jQuery),window.stop_ajax=!1,jQuery(function(p){var t=p(".breadcrumb"),e=t.data("menu");if(e){var o=p(".side-nav a[data-key="+e+"]"),n=[];if(0<o.length)if(o.is(".menu_top"))n.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+o.find("i").attr("class")+'"></i>&nbsp;'+o.text()+"</a></li>");else{var i=o.parents(".collapse").eq(0);i.addClass("show"),o.addClass("active");var a=i.siblings(".card-header").find("a.menu_top");n.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+a.find("i").attr("class")+'"></i>&nbsp;'+a.text()+"</a></li>"),n.push('<li class="breadcrumb-item"><a href="javascript:">'+o.text()+"</a></li>")}var s=t.data("title");s&&n.push('<li class="breadcrumb-item active" aria-current="page">'+s+"</li>"),t.html(n.join("\n"))}p(window).on("scroll",function(t){}).trigger("scroll"),p(".checkall-btn").click(function(t){var e=p(this).data("target");e||(e="id");var o=p("[name="+e+"]");p(this).is(".active")?o.prop("checked",!1):o.prop("checked",!0)}),p(".checkreverse-btn").click(function(t){var e=p(this).data("target");e||(e="id");for(var o=p("[name="+e+"]"),n=0;n<o.length;n++)o[n].checked?o.eq(n).prop("checked",!1):o.eq(n).prop("checked",!0)}),p(".action-btn").click(function(t){t.preventDefault();var e=p(this).data("action");if(!e)return dialog.error("未知操作");if(e="action"+e.replace(/^[a-z]/,function(t){return t.toUpperCase()}),!window[e]||"function"!=typeof window[e])return dialog.error("未知操作");var o=p(this).data("needChecks");if(void 0===o&&(o=!0),o){var n=p(this).data("target");n||(n="id");var i=p("[name="+n+"]:checked");if(i.length<1)return dialog.warning("请选择需要操作的项目");for(var a=[],s=0;s<i.length;s++)a.push(i.eq(s).val());window[e](a)}else window[e]()}),p(".chgstatus").click(function(t){if(!p(this).data("ajaxing")){p(this).data("ajaxing",1);var o=p(this),e=o.parents("td"),n=e.data("id"),i=o.data("status");p.ajax({url:e.data("url"),type:"POST",dataType:"JSON",data:{id:n,status:i},success:function(t){if(o.data("ajaxing",0),1==t.code){dialog.success(t.msg),o.toggleClass("off");var e=o.attr("title").replace("点击","");o.text(e),setTimeout(function(){location.reload()},1e3)}else dialog.error(t.msg)}})}}),p(".operations .btn").tooltip(),p("a[rel=ajax]").click(function(t){t.preventDefault();var o=p(this),e=p(this).data("title");e||(e=p(this).text()),e||(e=p(this).attr("title"));new Dialog({btns:["确定"],onshow:function(e){p.ajax({url:o.attr("href"),beforeSend:function(t){t.setRequestHeader("X-Requested-With","htmlhttp")},success:function(t){e.html(t)}})}}).show('<p class="loading">'+lang("loading...")+"</p>",e)}),p(".link-confirm").click(function(t){t.preventDefault(),t.stopPropagation();var e=p(this).data("confirm"),o=p(this).attr("href");e&&(e=e.replace(/(\\n|\n)+/g,"<br />")),e||(e=lang("Confirm operation?")),dialog.confirm(e,function(){p.ajax({url:o,dataType:"JSON",success:function(t){dialog.alert(t.msg),1==t.code&&(t.url?location.href=t.url:location.reload())},error:function(){dialog.alert(lang("Server error."))}})})}),p(".img-view").click(function(t){t.preventDefault(),t.stopPropagation();var e=p(this).attr("href");e||(e=p(this).data("img"));new Dialog({btns:["确定"]}).show('<a href="'+e+'" class="d-block text-center" target="_blank"><img class="img-fluid" src="'+e+'" /></a><div class="text-muted text-center">点击图片在新页面放大查看</div>',"查看图片")}),p(".nav-tabs a").click(function(t){t.preventDefault(),p(this).tab("show")}),p(".custom-file .custom-file-input").on("change",function(){var e=p(this);if(this.files&&this.files[0]){var t=p(this).parents(".input-group").eq(0),o=t.parents("div").eq(0),n=p(this).parents(".custom-file").find(".custom-file-label");if(n.data("origtext")||n.data("origtext",n.text()),n.text(p(this).val()),window.URL||window.URL.createObjectURL){var i=e[0].files[0],a=i.type&&i.type.match(/(\.|\/)(jpe?g|png|gif|webp)$/),s=o.find(".figure");if(s.length||(o.append('<figure class="figure">\n                            <img src="/static/images/blank.gif" class="figure-img img-fluid rounded" alt="image">\n                            <figcaption class="figure-caption text-center"></figcaption>\n                        </figure>'),s=o.find(".figure")),a){var r=s.find("img"),c=r.data("origurl");c||(c=r.attr("src"),r.data("origurl",c));var l=s.find("figcaption");void 0===l.data("origtext")&&l.data("origtext",l.text()),r.attr("src",window.URL.createObjectURL(i)),l.text(e.val())}var d=t.find("a.cancel");d.length||(t.append('<div class="input-group-append"><a href="javascript:" class="btn btn-outline-danger cancel">取消</a></div>'),(d=t.find("a.cancel")).click(function(t){dialog.confirm("取消上传该文件?",function(){e.val(""),n.text(n.data("origtext")),a&&(r.attr("src",c),l.text(l.data("origtext"))),d.parent().remove()})}))}}}),p(".btn-primary[type=submit]").click(function(t){var e=p(this).parents("form");if(e.is(".noajax"))return!0;var o=this,n="BUTTON"==p(o).prop("tagName").toUpperCase(),i=n?p(o).text():p(o).val(),a={url:p(e).attr("action"),type:"POST",dataType:"JSON",success:function(t){window.stop_ajax=!1,n?p(o).text(i):p(o).val(i),1==t.code?dialog.alert(t.msg,function(){t.url?location.href=t.url:location.reload()}):(dialog.warning(t.msg),p(o).removeAttr("disabled"))},error:function(t){window.stop_ajax=!1,n?p(o).text(i):p(o).val(i),p(o).removeAttr("disabled"),dialog.error("服务器处理错误")}};if("multipart/form-data"===e.attr("enctype")){if(!FormData)return!(window.stop_ajax=!1);a.data=new FormData(e[0]),a.cache=!1,a.processData=!1,a.contentType=!1,a.xhr=function(){var t=p.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){var e=Math.floor(t.loaded/t.total*100);p(o).text(i+"  ("+e+"%)")},!1),t}}else a.data=p(e).serialize();t.preventDefault(),p(this).attr("disabled",!0),window.stop_ajax=!0,p.ajax(a)}),p(".pickuser").click(function(t){var e=p(this).parents(".input-group"),o=e.find("[name=member_id]"),n=e.find("[name=member_info]");dialog.pickUser(function(t){o.val(t.id),n.val("["+t.id+"] "+t.username+(t.mobile?" / "+t.mobile:""))},p(this).data("filter"))}),p(".pick-locate").click(function(t){var e=p(this).parents(".input-group").find("input[type=text]");dialog.pickLocate("qq",function(t){e.val(t.lng+","+t.lat)},e.val())})});
//# sourceMappingURL=app.min.js.map
